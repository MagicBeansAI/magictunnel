# Capability-Level Pattern Rules for MagicTunnel Enterprise Allowlist
# These patterns auto-apply to new tools matching the regex patterns
# Lower priority numbers = higher precedence (evaluated first)

capability_patterns:
  # Security-critical operations (highest priority)
  - name: "destructive_operations"
    pattern:
      type: regex
      value: ".*(?:delete|destroy|remove|rm|kill|terminate|drop|truncate|purge).*"
    action: deny
    reason: "Destructive operations require explicit approval"
    priority: 1
    enabled: true
    
  - name: "system_administration"
    pattern:
      type: regex  
      value: ".*(?:sudo|admin|root|chmod|chown|passwd|useradd|userdel|systemctl|service).*"
    action: deny
    reason: "System administration tools blocked by default"
    priority: 2
    enabled: true
    
  - name: "network_security"
    pattern:
      type: regex
      value: ".*(?:ssh|telnet|ftp|sftp|rsync|scp|wget|curl|nc|netcat|nmap|ping).*"
    action: deny
    reason: "Network tools require security review"
    priority: 3
    enabled: true

  # File operations (medium priority)
  - name: "file_write_operations"
    pattern:
      type: regex
      value: "file_(?:write|create|save|copy|move).*"
    action: allow
    reason: "Standard file operations permitted"
    priority: 10
    enabled: true
    
  - name: "file_read_operations"
    pattern:
      type: regex
      value: "file_(?:read|get|list|stat|info).*"
    action: allow
    reason: "Read operations generally safe"
    priority: 15
    enabled: true

  # Database operations (medium priority)  
  - name: "database_write"
    pattern:
      type: regex
      value: "(?:db|database)_(?:write|insert|update|create|save).*"
    action: deny
    reason: "Database write operations require approval"
    priority: 5
    enabled: true
    
  - name: "database_read"
    pattern:
      type: regex
      value: "(?:db|database)_(?:read|select|query|get|list).*"
    action: allow
    reason: "Database read operations permitted"
    priority: 20
    enabled: true

  # Development tools (lower priority)
  - name: "development_tools"
    pattern:
      type: regex
      value: "(?:git|npm|pip|cargo|mvn|gradle|make|build|compile|test).*"
    action: allow
    reason: "Development tools generally permitted"
    priority: 30
    enabled: true
    
  - name: "code_generation"
    pattern:
      type: regex
      value: ".*(?:generate|scaffold|template|boilerplate).*"
    action: allow
    reason: "Code generation tools permitted"
    priority: 35
    enabled: true

  # Communication tools (lower priority)
  - name: "messaging_tools"
    pattern:
      type: regex
      value: "(?:slack|teams|discord|email|sms|notification).*"
    action: allow
    reason: "Communication tools permitted with monitoring"
    priority: 40
    enabled: true

  # Generic safe operations (lowest priority)
  - name: "info_gathering"
    pattern:
      type: regex
      value: ".*(?:info|status|health|version|help|list|show|display).*"
    action: allow
    reason: "Information gathering is safe"
    priority: 50
    enabled: true

# Configuration metadata
metadata:
  version: "1.0.0"
  created: "2025-01-15"
  description: "Capability-level patterns for automatic rule application"
  total_patterns: 11
  
# Pattern testing configuration
testing:
  enabled: true
  test_cases:
    - tool_name: "file_delete_user_data"
      expected_match: "destructive_operations"
      expected_action: "deny"
    - tool_name: "file_read_config"
      expected_match: "file_read_operations" 
      expected_action: "allow"
    - tool_name: "sudo_install_package"
      expected_match: "system_administration"
      expected_action: "deny"
    - tool_name: "git_clone_repo"
      expected_match: "development_tools"
      expected_action: "allow"